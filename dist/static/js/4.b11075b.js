(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"2c7E":function(t,s,a){"use strict";var e=a("N7Dd");a.n(e).a},N7Dd:function(t,s,a){},q3zG:function(t,s,a){"use strict";a.r(s);var e=a("bS4n"),o=a.n(e),i=a("WRrH"),r={name:"allStock",data:function(){return{show:!1,curIndex:-1,curGoodsIndex:-1,tableData:[],lastScroll:2,returnTop:!1}},created:function(){this.storageData.allShopData&&this.storageData.allShopData.length||(this.$store.commit("staticData/setScreenParams",{pageNum:0}),this.getBaseData(!0))},methods:{getStockDetail:function(t,s){var a=this,e=this.staticData.screenParams,o=e.importDate,i=e.week,r=e.type,n=e.gtSingle;if(t){var l={importDate:o,week:i,type:r,gtSingle:n};l.styleNo=s.styleNo,this.Apis.base.getGoodsInfo(l).then(function(t){a.$store.commit("setDataByStateStr",{str:"storageData/baseGoodsInformationList",data:t.data})})}},getBaseData:function(t){this.$store.dispatch("asyncData/getBaseGoodsList",t)},saveFilter:function(){this.getBaseData(!0),this.rightClick()},rightClick:function(){this.show?this.show=!1:this.show=!0},sizeSummary:function(t){var s=this,a=t.importDate,e=t.styleNo;this.Apis.base.getBaseGoodsInfo({importDate:a,styleNo:e}).then(function(t){1==t.result?(s.$store.commit("storageData/changeGoodsInfo",t.data),s.$router.push("/goodsDetail")):s.$toast.fail("无商品数据")})},showShopDetail:function(t,s,a){var e=this,o=a.importDate,i=a.styleNo,r=a.storeName;if(this.curIndex==t&&this.curGoodsIndex==s)this.curIndex=-1,this.curGoodsIndex=-1;else{var n={importDate:o,styleNo:i,storeName:r};this.Apis.shop.getStockDetail(n).then(function(a){e.$store.commit("setDataByStateStr",{str:"storageData/clickGoodsStock",data:a.data}),e.curIndex=t,e.curGoodsIndex=s})}},addSweepList:function(t){var s=this,a=t.storeName,e=t.styleNo;this.$toast.clear();var o={importDate:this.staticData.screenParams.importDate,storeName:a,styleNo:e};this.Apis.goods.addSweepList(o).then(function(t){1==t.result?s.$toast.success("添加成功"):s.$toast.fail("添加失败")})},follow:function(t,s){var a=this,e=void 0,o=t.styleNo,i=void 0;t.$checked?(t.$checked=!1,i="goodsDelFollow",e="取消关注"):(t.$checked=!0,i="goodsAddFollow",e="关注成功"),this.storageData.allShopData.splice(s,1,t),this.Apis.goods[i]({styleNo:o}).then(function(t){"取消关注"==e&&a.storageData.allShopData.splice(s,1),a.$toast.success(e)})},loadMore:function(t){var s=t.target.scrollHeight-t.target.scrollTop-t.target.clientHeight;if(s<=this.lastScroll){this.lastScroll=s;var a=1*this.staticData.screenParams.pageNum+1;this.$store.commit("staticData/setScreenParams",{pageNum:a}),this.getBaseData()}t.target.scrollTop>=t.target.scrollHeight/4?(t.target.scrollTop<this.thisScroll?this.returnTop=!0:this.returnTop=!1,this.thisScroll=t.target.scrollTop):this.returnTop=!1},returnOfTop:function(){var t=this;console.log("return top click"),window.returnTopTimer=setInterval(function(){t.$refs["page-main-all"].scrollTop-=t.$refs["page-main-all"].scrollTop/30,t.$refs["page-main-all"].scrollTop<=0&&clearInterval(window.returnTopTimer)},10)}},computed:o()({},Object(i.d)({asyncData:function(t){return t.asyncData},staticData:function(t){return t.staticData},storageData:function(t){return t.storageData}})),watch:{"staticData.isLookFollow":function(t,s){var a=this;t?this.$store.dispatch("asyncData/getFollowList").then(function(){a.getBaseData(!0)}).catch(function(t){a.storageData.setAllShopData=[]}):(this.$store.commit("staticData/setScreenParams",{styleNos:""}),this.getBaseData(!0))}}},n=(a("2c7E"),a("ZpG+")),l=Object(n.a)(r,function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("div",{ref:"screenBtn",staticClass:"msp_page"},[a("head-bar",{attrs:{title:"全国库存"}},[a("search-bar",{attrs:{show:t.show},on:{search:function(s){return t.getBaseData(!0)}}}),t._v(" "),a("div",{staticClass:"iconfont icon-shaixuan1 detail_headerR",attrs:{slot:"right"},on:{click:function(s){return s.stopPropagation(),t.rightClick(s)}},slot:"right"})],1),t._v(" "),a("div",{ref:"page-main-all",staticClass:"msp_page_main",on:{scroll:t.loadMore}},[a("screen",{attrs:{offset:function(){return t.$refs.screenBtn}},on:{save:t.saveFilter},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}}),t._v(" "),t._l(t.storageData.allShopData,function(s,e){return a("van-row",{key:e},[a("van-col",{staticClass:"page_main_one",attrs:{span:"24"}},[a("van-card",[a("img",{directives:[{name:"lazy",rawName:"v-lazy",value:s.imgUrls,expression:"item.imgUrls"}],attrs:{slot:"thumb",alt:""},slot:"thumb"}),t._v(" "),a("div",{staticClass:"tagImg",attrs:{slot:"tag"},slot:"tag"},[a("div",{staticClass:"tagIcon"}),t._v(" "),a("div",{staticClass:"tagInfo"},[t._v("到")])]),t._v(" "),a("van-row",{staticClass:"row_div",attrs:{slot:"desc"},slot:"desc"},[a("van-col",{staticClass:"textHidden flexCenter",attrs:{span:"21"}},[a("div",[t._v(t._s("货号："+s.styleNo))]),t._v(" "),a("div",{staticClass:"red_tags"},[t._v(t._s(s.sex))])]),t._v(" "),a("van-col",{staticClass:"textHidden",attrs:{span:"3"}},[a("img",{staticClass:"icon_img",attrs:{src:s.$checked?s.starImg:s.star_Img},on:{click:function(a){return t.follow(s,e)}}})])],1),t._v(" "),a("van-row",{staticClass:"row_div",attrs:{slot:"desc"},slot:"desc"},[1==s.isArrive?a("van-col",{staticClass:"textHidden",attrs:{span:"24"}},[t._v(t._s("到货："+s.arriveInterval))]):t._e()],1),t._v(" "),a("van-row",{staticClass:"row_div",attrs:{slot:"desc"},slot:"desc"},[a("van-col",{staticClass:"textHidden",attrs:{span:"12"}},[t._v(t._s("在库数量："+s.onHand))]),t._v(" "),1==s.isArrive?a("van-col",{staticClass:"textHidden",attrs:{span:"12"}},[t._v(t._s("到货数量："+s.arriveNum))]):t._e()],1),t._v(" "),1==s.isDeduce?a("van-row",{staticClass:"row_div"},[a("van-col",{staticClass:"textHidden",attrs:{span:"12"}},[t._v("降价日期：")]),t._v(" "),a("van-col",{staticClass:"textHidden",attrs:{span:"12"}},[t._v(t._s(s.deduceDate))])],1):t._e(),t._v(" "),a("van-row",{staticClass:"row_div",attrs:{slot:"desc"},slot:"desc"},[a("van-col",{staticClass:"_price textHidden",attrs:{span:"12"}},[t._v("折扣价：￥"+t._s(s.newMkdString))]),t._v(" "),a("van-col",{staticClass:"origin_price textHidden",attrs:{span:"12"}},[t._v("吊牌价：￥"+t._s(s.msrpString))])],1),t._v(" "),a("van-row",{staticClass:"row_div colorWeak",attrs:{slot:"desc"},slot:"desc"},[a("van-col",{staticClass:"textHidden",attrs:{span:"24"}},[t._v(t._s(s.styleName))])],1),t._v(" "),s.special?a("van-row",{staticClass:"row_div",attrs:{slot:"tags"},slot:"tags"},[a("van-col",{staticClass:"textHidden tags_col",attrs:{span:"24"}},[a("div",{staticClass:"tags_div"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(s.specialDate)+"\n\t\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"tags_div"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(s.specialDiscount)+"\n\t\t\t\t\t\t\t")])])],1):t._e(),t._v(" "),s.showDiscount?a("van-row",{staticClass:"row_red_div textHidden",attrs:{slot:"desc"},slot:"desc"},[t._v("\n\t\t\t\t\t\t"+t._s("折扣率："+s.discountString)+"\n\t\t\t\t\t")]):t._e(),t._v(" "),a("van-row",{staticClass:"row_div",attrs:{slot:"tags"},slot:"tags"},[a("van-col",{staticClass:"textHidden tags_col",attrs:{span:"24"}},[a("div",{staticClass:"tags_div"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(s.categoryString)+"\n\t\t\t\t\t\t\t")]),t._v(" "),a("div",{staticClass:"tags_div"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(s.subCategory)+"\n\t\t\t\t\t\t\t")])])],1),t._v(" "),a("van-row",{staticClass:"row_div",attrs:{slot:"tags"},slot:"tags"},[a("van-col",{staticClass:"tags_col menu_list",attrs:{span:"24"}},[a("div",{staticClass:"menu_blueColor",on:{click:function(a){return t.sizeSummary(s)}}},[t._v("尺码汇总")]),t._v(" "),a("div",{staticClass:"menu_blueColor",on:{click:function(a){return t.addSweepList(s)}}},[t._v("加入扫货单")])])],1)],1),t._v(" "),a("van-collapse",{attrs:{accordion:""},on:{change:function(a){return t.getStockDetail(a,s)}},model:{value:t.storageData.collapseModel[e].model,callback:function(s){t.$set(t.storageData.collapseModel[e],"model",s)},expression:"storageData['collapseModel'][index]['model']"}},[a("van-collapse-item",{attrs:{size:"large",name:t.storageData.collapseModel[e].name,title:"货品信息"}},[a("div",{staticClass:"msg_size_list textHidden"},[a("van-row",{staticClass:"flexCenter"},t._l(t.staticData.allStockTableHead,function(s,e){return a("van-col",{key:e,staticClass:"textC border_list list_head",class:{minW_o:0==e,minW_t:3==e,end_list:4==e,minW_r:1==e||2==e||5==e}},[t._v("\n\t\t\t\t\t\t\t\t\t"+t._s(s)+"\n\t\t\t\t\t\t\t\t")])}),1),t._v(" "),t._l(t.storageData.baseGoodsInformationList,function(s,o){return a("div",{key:o,staticClass:"flexColumn",on:{click:function(a){return t.showShopDetail(o,e,s)}}},[a("div",{staticClass:"flexCenter"},[a("div",{staticClass:"textC border_list minW_o"},[t._v(t._s(s.storeName))]),t._v(" "),a("div",{staticClass:"textC border_list minW_r"},[t._v(t._s(s.onHand))]),t._v(" "),a("div",{staticClass:"textC border_list minW_r"},[t._v(t._s(s.arriveNum))]),t._v(" "),a("div",{staticClass:"textC border_list minW_t"},[t._v(t._s(s.buyerName?s.buyerName:"无"))]),t._v(" "),a("div",{staticClass:"textC border_list end_list"},[t._v(t._s(s.onHand>0?s.arriveDate?"在库/"+s.arriveDate:"在库":s.arriveDate))]),t._v(" "),a("div",{staticClass:"textC border_list minW_r"},[a("div",{staticClass:"list_blueColor",on:{click:function(a){return a.stopPropagation(),t.addSweepList(s)}}},[t._v("加入")])])]),t._v(" "),a("transition",{attrs:{name:"slide"}},[t.curIndex==o&&t.curGoodsIndex==e?a("div",{staticClass:"msg_size_list slide_table"},[a("van-row",{staticClass:"flexCenter"},t._l(t.staticData.goodsDetailHead,function(s,e){return a("van-col",{key:e,staticClass:"textC border_list list_head",class:{minW:e<3,endW:3==e}},[t._v(t._s(s))])}),1),t._v(" "),t._l(t.storageData.clickGoodsStock,function(s,e){return a("van-row",{key:e,staticClass:"flexCenter"},[a("van-col",{staticClass:"textC border_list minW"},[t._v(t._s(s.size))]),t._v(" "),a("van-col",{staticClass:"textC border_list minW"},[t._v(t._s(s.onHand))]),t._v(" "),a("van-col",{staticClass:"textC border_list minW"},[t._v(t._s(s.arriveNum))]),t._v(" "),a("van-col",{staticClass:"textC border_list endW"},[t._v(t._s(s.onHand>0?s.arriveDate?"在库/"+s.arriveDate:"在库":s.arriveDate))])],1)})],2):t._e()])],1)})],2)])],1)],1)],1)}),t._v(" "),t.storageData.allShopData.length?t._e():a("div",{staticClass:"noGoodsMsg"},[t._v("\n\t\t\t--------我是有底线的--------\n\t\t")])],2),t._v(" "),a("div",{staticClass:"rightPopup",on:{click:t.returnOfTop}},[a("van-popup",{attrs:{position:"right",overlay:!1},model:{value:t.returnTop,callback:function(s){t.returnTop=s},expression:"returnTop"}},[a("van-icon",{attrs:{name:"arrow-up",size:"20px"}}),t._v(" "),a("div",[t._v("返回")]),t._v(" "),a("div",[t._v("顶部")])],1)],1)],1)},[],!1,null,"6ab84e3f",null);s.default=l.exports}}]);